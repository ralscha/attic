<HTML>
<HEAD><TITLE>Deja News - Article</TITLE>

</HEAD>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#52188c" alink="#ff0000">


<table height=70 width=470 cellpadding=0 cellspacing=0 border=0>
<tr valign=top align=right>
<td height=70 width=103><a href="http://w.dejanews.com/"><img src="http://w.dejanews.com/gifs/dnlogo_r7.gif" align=middle alt="Deja News" height=70 width=103 border=0></a></td>
<td height=70 width=367 nowrap><img src="http://w.dejanews.com/gifs/1x1.gif" align=bottom alt="" height=22 width=1 border=0><a href="http://w.dejanews.com/"><b>Home</b></a>&nbsp;&#183;
<a href="http://gp.dejanews.com/gtplacer?site=dn&location=link.home.infospace&cid=883929212.702545962"><b>Online Resources</b></a><br>
<img src="http://w.dejanews.com/gifs/redline.gif" alt="-------------------------------------" height=2 width=367 vspace=2 border=0><br>
<font size=1><a href="http://w.dejanews.com/home_qs.shtml">Quick Search</a>&nbsp;&#183;
<a href="http://w.dejanews.com/home_ps.shtml">Power Search</a>&nbsp;&#183;
<a href="http://w.dejanews.com/home_sf.shtml">Search Filter</a>&nbsp;&#183;
<a href="http://w.dejanews.com/home_if.shtml">Interest Finder</a>&nbsp;&#183;
<a href="http://w.dejanews.com/home_bg.shtml">Browse Groups</a></font>
<br>
<font size=5>&nbsp;</font><a href="http://gp.dejanews.com/gtplacer?site=dn&location=link.dynamic.ibm&cid=883929212.702545962"><font color=c60012>IBM Netfinity...just better business</font></a></td></tr>
<tr><td colspan=2><hr noshade size=1></td></tr>
</table>

<table cellspacing=0 cellpadding=0 width=470 border=0><tr><td>
<A HREF="http://gp2.dejanews.com/gtc?id=10270&tm=883929212.747610&site=dn&location=comp.lang.java.programmer&keywords=save%20canvas%20in%20java&cr=%7cjava%7c%7c%7c%7c%7c%7c%7c">
<IMG ALIGN=MIDDLE HEIGHT=60 WIDTH=468 SRC="http://web2.dejanews.com/ads/52/4142909952-6295.gif" ALT="Visual SlickEdit 3.0 - The editor of choice for Java. Download your free trial." border=1></A></td></tr><tr align=center><td><font size=-1><A HREF="http://gp2.dejanews.com/gtc?id=10270&tm=883929212.747610&site=dn&location=comp.lang.java.programmer&keywords=save%20canvas%20in%20java&cr=%7cjava%7c%7c%7c%7c%7c%7c%7c">
Visual SlickEdit 3.0 - The editor of choice for Java. Download your free trial.</a></font></td></tr>
</table><br>
<table bgcolor=ffffff cellspacing=0 cellpadding=2 width=470 border=0>
<tr><td colspan=3></td>
<td width=90 valign=middle align=right rowspan=3><a href="http://gp.dejanews.com/gtplacer?site=dn&location=link.dyn.tripod&cid=1"><img src="http://w.dejanews.com/gifs/tripod.gif" width=88 height=31 border=1 alt="Free Homepages!"></a></td></tr>
<tr><td bgcolor="#cccccc" width=100%><font face="arial,helvetica" size=4><b>&nbsp;Article 2 of exactly 7</b></font></td>
<td bgcolor="#cccccc" align=right nowrap><a href="getdoc.xp?recnum=10490984&server=db97p6&CONTEXT=883928962.702414870&hitnum=1&fmt=raw">Text Only<img src="http://w.dejanews.com/gifs/text.gif" align=absmiddle width=22 height=20 border=0 alt=""></a>&nbsp;&nbsp;&nbsp;<a href="http://w.dejanews.com/help/help_art.shtml">Help<img src="http://w.dejanews.com/gifs/qm.gif" width=22 height=20 border=0 align=absmiddle alt="?"></a></td></tr>
<tr><td></td></tr>
</table>
<table cellspacing=0 cellpadding=2 border=0><tr align=center>
<td><A HREF="http://x8.dejanews.com/getdoc.xp?recnum=975642&server=db97p6&CONTEXT=883928962.702414870&hitnum=0"><IMG ALT="[Previous Article]" BORDER=0 SRC="http://w.dejanews.com/gifs/prev.gif" width=31 height=25 hspace=6><br><font size=-1>Previous<br>Article</font></A></td>
<td><A HREF="http://x8.dejanews.com/getdoc.xp?recnum=9740044&server=db97p6&CONTEXT=883928962.702414870&hitnum=2"><IMG ALT="[Next Article]" BORDER=0 SRC="http://w.dejanews.com/gifs/next.gif" width=32 height=25 hspace=6><br><font size=-1>Next<br>Article</font></A></td>
<td><A HREF="http://x8.dejanews.com/dnquery.xp?search=next&ST=QS&site=dn&offsets=&CONTEXT=883928962.702414870"><IMG ALT="[Current Results]" BORDER=0 SRC="http://w.dejanews.com/gifs/curr.gif" width=26 height=27 hspace=6><br><font size=-1>Current<br>Results</font></A></td>
<td><A HREF="http://x8.dejanews.com/dnquery.xp?search=thread&filter=%7bdb97p6%20%7b%7b%7ec%20%7b%23*%23%20%26!%20(sex%20%7c%20jobs)%7d%7d%7d%7d&svcclass=dncurrent&threaded=1&ST=PS&CONTEXT=883928962.702414870&HIT_CONTEXT=883928962.702414870&HIT_NUM=1&recnum=%3c34AB205F.DF5059F8@bellsouth.net%3e%231/1"><IMG ALT="[View Thread]" BORDER=0 SRC="http://w.dejanews.com/gifs/thr.gif" width=34 height=27 hspace=6><br><font size=-1>View<br>Thread</font></A></td>
<td><A HREF="/profile.xp?author=kurt%20spaugh%20%3cspaugh@bellsouth.net%3e&ST=PS"><IMG ALT="[Author Profile]" BORDER=0 SRC="http://w.dejanews.com/gifs/auth.gif" width=25 height=28 hspace=6><br><font size=-1>Author<br>Profile</font></A></td>
<td><A HREF="http://postnews.dejanews.com/post.xp?NG=comp.lang.java.programmer"><IMG ALT="[Post Message]" BORDER=0 WIDTH=31 HEIGHT=28 hspace=6 SRC="http://w.dejanews.com/gifs/post_a.gif"><br><font size=-1>Post<br>Message</font></A></td>
</tr></table><br><PRE>
<B>Subject:      <FONT SIZE=+1 color="#c60012">Re: How to create a Gif with Alpha information?</FONT>
From:         kurt spaugh &lt;spaugh@bellsouth.net&gt;
Date:         1998/01/01
Message-ID:   &lt;34AB205F.DF5059F8@bellsouth.net&gt;
Newsgroups:   comp.lang.java.programmer,comp.lang.java.help,comp.lang.java.gui
<A HREF="http://x8.dejanews.com/getdoc.xp?recnum=10490984&server=db97p6&CONTEXT=883928962.702414870&hitnum=1&AH=1">[More Headers]</A>
</B>

The following code makes a transparent image from a gif file, or any other image
type loadable thru getImage(), using the alpha color channel.

This transparency is a behavior of <B>java</B> images, as opposed to the
'transparent' gif format, which is a property of the GIF89a specifications.
Think of it this way:

  GIF89a 'transparent gif'  - one color transparent
  'image with transparency' - all colors transparent

It is important to know that the 'alpha' channel does not really exist in
most (any?) video adapters. The see-through quality is added during rendering.

When you change the alpha value, <B>java</B> dithers the image with see-thru pixels.
This simulates a transparent image. At some transparency values the dithering
will be more obvious, with noticable moire. It depends on resolution and the
background you paint on.

The class is poorly named: It is a <B>Canvas</B>, and displays itself.
I wrapped the logic in a <B>Canvas</B> to look at it. You can do what you like.
I would have changed the name to ImageCanvasWithTransparency, but I was afraid
the code police would cite me for 'Creeping Verbosity' :-)

  e.g. main(String..){
         ImageWithTransparency img(&quot;mygif.gif&quot;, .25 );  //mostly (.75) opaque
         add(img);

have fun

kurt <A HREF="/profile.xp?author=spaugh@bellsouth.net&ST=QS">spaugh@bellsouth.net</A>

import <B>java</B>.awt.*;
import <B>java</B>.awt.image.*;
class ImageWithTransparency extends <B>Canvas</B>{

   Image src,img;
   int pix[];
   //
   // load image 'name', with pct transparency.
   //   [opaque-&gt; 0.0&lt;= pct &lt;=1.0 &lt;-seeThru]
   // the alpha channel is added, if needed
   // e.g. ImageWithTransparency t=new ImageWithTransparency(&quot;myfile.gif&quot;, 0.2);
   //
   public ImageWithTransparency( String name,double pct){
      super();

      // load image from disk
      src=getToolkit().getDefaultToolkit().getImage(name);
      MediaTracker mt=new MediaTracker(this);
      mt.addImage(src,1);
      try{
        mt.waitForID(1);
      }catch(InterruptedException e){}

      // get pixels
      PixelGrabber p=new PixelGrabber(src,0,0,
              src.getWidth(this),src.getHeight(this),true);
      try{
        p.grabPixels();
      }catch(InterruptedException ie){}
      pix=(int[])p.getPixels();

      // create a filter
      AlphaImageFilter filter;
      filter=new AlphaImageFilter(pix,pct);

      //create the image with a filter
      img=getToolkit().getDefaultToolkit().createImage(
              new FilteredImageSource( src.getSource(),filter));
      mt.addImage(img,1);
      try{
        mt.waitForID(1);
      }catch(InterruptedException e){}
      int w=img.getWidth(this);
      int h=img.getHeight(this);
      setSize(w,h);
   }
   public void paint(Graphics g) {
      g.drawImage(img,0,0,this);
   }
}
class AlphaImageFilter extends ImageFilter{
   int pix[];
   double amt;
   int alpha;

   public AlphaImageFilter(int p[],double amount){
      super();
      alpha= ((int)((1.0-amount)*255.0))&lt;&lt;24;
      pix=p;                // <B>save</B> int[] of pixels
   }
   // setPixels with int[]
   public void setPixels(int x,int y, int w, int h,
                         ColorModel m,int p[],int o,int s){
      for(int i=0;i&lt;p.length;i++){
         p[i]=(p[i]&amp;0xffffff)|alpha;
      }
      super.setPixels(x,y,w,h,m,p,o,s);
   }

   // setPixels with byte[]
   public void setPixels(int x,int y, int w, int h,
                         ColorModel m,byte p[],int o,int s){
      // no alpha here,that I know of, call other setPixels
      // there's probably a better way to get to the alpha channel...
      // ...from here, but this gets it done.
      // call the int[] version of setPixel...
      // ...with the pix array given in constructor, and a new ColorModel
      setPixels(x,y,w,h,ColorModel.getRGBdefault(),pix,o,s);
   }
}


Kam Bansal wrote:

&gt; Hi all,
&gt;
&gt; Well, on my never ending quest to get 2 gifs overlayed with each other, the second being at 50%
&gt; transparency, this is where I am. According to the &quot;2D API Enhanced Graphics and Imaging for <B>Java</B>&quot;
&gt; by Sun, they say -
&gt;
&gt; &quot;Images can carry TRANSPARENCY information for each pixel in the image. This information is called
&gt; an ALPHA CHANNEL, is used in conjunction with the current Composite object to blend the image with
&gt; an existing drawing.&quot;
&gt;
&gt; Now, they don't go into how to initially create an image with alpha information! Does anyone know
&gt; how to (a) create a gif with alpha inforamation, or (b) how to modify a gif to add an alpha?
&gt;
&gt; Apart from that, have a great new years!
&gt;
&gt;                                                         -Kam (^8*
&gt;
&gt; ===============
&gt; Kam Bansal (^8*
&gt; <A HREF="/profile.xp?author=kamb@jps.net&ST=QS">kamb@jps.net</A>
</PRE>


<hr width=470 align=left><br><table cellspacing=0 cellpadding=0 width=470 border=0><tr><td>
<A HREF="http://gp2.dejanews.com/gtc?id=10270&tm=883929212.747610&site=dn&location=comp.lang.java.programmer&keywords=save%20canvas%20in%20java&cr=%7cjava%7c%7c%7c%7c%7c%7c%7c">
<IMG ALIGN=MIDDLE HEIGHT=60 WIDTH=468 SRC="http://web2.dejanews.com/ads/52/4142909952-6295.gif" ALT="Visual SlickEdit 3.0 - The editor of choice for Java. Download your free trial." border=1></A></td></tr><tr align=center><td><font size=-1><A HREF="http://gp2.dejanews.com/gtc?id=10270&tm=883929212.747610&site=dn&location=comp.lang.java.programmer&keywords=save%20canvas%20in%20java&cr=%7cjava%7c%7c%7c%7c%7c%7c%7c">
Visual SlickEdit 3.0 - The editor of choice for Java. Download your free trial.</a></font></td></tr>
</table>
<table cellspacing=0 cellpadding=0 border=0><tr valign=center>
<td><nobr><hr align=left noshade size=1 width=470>
<font size=-1 color="#666666"><A HREF="http://x8.dejanews.com/getdoc.xp?recnum=975642&server=db97p6&CONTEXT=883928962.702414870&hitnum=0">Previous</A> &nbsp;|&nbsp; 
<A HREF="http://x8.dejanews.com/getdoc.xp?recnum=9740044&server=db97p6&CONTEXT=883928962.702414870&hitnum=2">Next</A> &nbsp;|&nbsp; 
<A HREF="http://x8.dejanews.com/dnquery.xp?search=next&ST=QS&site=dn&offsets=&CONTEXT=883928962.702414870">Results</A> &nbsp;|&nbsp; 
<A HREF="http://x8.dejanews.com/dnquery.xp?search=thread&filter=%7bdb97p6%20%7b%7b%7ec%20%7b%23*%23%20%26!%20(sex%20%7c%20jobs)%7d%7d%7d%7d&svcclass=dncurrent&threaded=1&ST=PS&CONTEXT=883928962.702414870&HIT_CONTEXT=883928962.702414870&HIT_NUM=1&recnum=%3c34AB205F.DF5059F8@bellsouth.net%3e%231/1">View Thread</A> &nbsp;|&nbsp; 
<A HREF="/profile.xp?author=kurt%20spaugh%20%3cspaugh@bellsouth.net%3e&ST=PS">Author Profile</A> &nbsp;|&nbsp; 
<A HREF="http://postnews.dejanews.com/post.xp?NG=comp.lang.java.programmer">Post Message</A> &nbsp;|&nbsp; 
<A HREF="http://postnews.dejanews.com/post.xp?NG=comp.lang.java.programmer&SUB=Re:%20How%20to%20create%20a%20Gif%20with%20Alpha%20information%3f&REF=%3c34AB205F.DF5059F8@bellsouth.net%3e&server=db97p6&recnum=10490984">Post Reply</A> &nbsp;|&nbsp; 
<A HREF="mailto:spaugh@bellsouth.net">Send Email</A></font></nobr></td></tr></table>
<table width=470 cellpadding=0 cellspacing=0 border=0>
<tr><td align=center><hr noshade size=1 width=470>
<font size=-1>Copyright &copy; 1995-97 <A HREF="http://w.dejanews.com/info/policy.shtml">Deja News, Inc.</A> All rights reserved.</font>
</td></tr>
</table>

</td></tr></table>
</body>
</html>